import os
import sys
from tqdm import tqdm
import subprocess

recips = ['Op']
exclude = []


def heat_maps():

	no_go_info = []
	
	go_by_taxon_by_og = { }
	
	for line in tqdm([line for line in open('ogs_to_use.txt')]):
		og = line.strip()
		if(og not in no_go_info):
				
			go_by_taxon = { }
				
			for line in open('../../FunctionSearching/' + og + '/eggnog_results.fa.emapper.annotations.tsv'):
				if(line[:2] in recips and line[:4] not in exclude and line[:5] not in exclude):
					if(line[:10] not in go_by_taxon):
						go_by_taxon.update({ line[:10] : { } })
						
					for term in [term.strip() for term in line.split('\t')[12].split(',') if term.strip() != '']:
						go_by_taxon[line[:10]].update({ term : 1 })
			
			try:
				for line in open('../../GoTermsFromPFams/' + og + '.tsv'):
					if(line[:2] in recips and line[:4] not in exclude and line[:5] not in exclude):
						if(line[:10] not in go_by_taxon):
							go_by_taxon.update({ line[:10] : { } })
					
						for term in [term.strip() for term in line.split('\t')[1].split(',') if term.strip() != '']:	
							go_by_taxon[line[:10]].update({ term : 1 })
			except:
				pass
				
			go_by_taxon_by_og.update({ og : go_by_taxon })
			
	all_gos = list(dict.fromkeys([go for og in go_by_taxon_by_og for taxon in go_by_taxon_by_og[og] for go in go_by_taxon_by_og[og][taxon]]))
	all_taxa = list(dict.fromkeys([taxon for og in go_by_taxon_by_og for taxon in go_by_taxon_by_og[og]]))
		
	print('\nWriting data from each OG to the output dataframes...\n')
	with open('go_by_og.csv', 'w') as o:
		o.write('Gene.Family,GO,N.Fungi,N.Met\n')
		for og in tqdm(go_by_taxon_by_og):
			
			for go in all_gos:
				fu_sum = 0; met_sum = 0
				for taxon in go_by_taxon_by_og[og]:
					if(go in go_by_taxon_by_og[og][taxon]):
						if(taxon[:5] == 'Op_fu'):
							fu_sum += 1
						elif(taxon[:5] == 'Op_me'):
							met_sum += 1
						
				#prop = float(sum) / float(len(go_by_taxon_by_og[og]))
				
				o.write(og + ',' + go + ',' + str(fu_sum) + ',' + str(met_sum) + '\n')
				
	with open('go_by_taxon.csv', 'w') as o:
		o.write('Taxon,GO,Prop.Occurs\n')
		go_counts_by_taxon = { }
		for taxon in tqdm(all_taxa):
			go_counts_by_taxon.update({ taxon : { } })
		
			total = 0
			for og in go_by_taxon_by_og:
				if(taxon in go_by_taxon_by_og[og]):
					total += 1
					
			for go in all_gos:
				go_counts_by_taxon[taxon].update({ go : 0 })
				for og in go_by_taxon_by_og:
					try:
						go_counts_by_taxon[taxon][go] += go_by_taxon_by_og[og][taxon][go]
					except KeyError:
						continue
						
			for go in all_gos:
				o.write(taxon + ',' + go + ',' + str(float(go_counts_by_taxon[taxon][go]) / float(total)) + '\n')
				

def top_terms_weighted_sums():

	weighted_counts_by_term = { }
	
	for line in open('tree_type_counts.csv'):
		try:
			term = line.split(',')[1]
			n_trees = int(line.split(',')[2]) + int(line.split(',')[3])
			if(n_trees >= 0):# and int(line.split(',')[2]) == 0 and int(line.split(',')[3]) > 0):
				weighted_counts_by_term.update({ term.replace('"', '') : 0 })
			else:
				print(term)
		except:
			continue
			
	print(len(weighted_counts_by_term))
	
	all_terms = []
	for l1 in open('ogs_to_use.txt'):
		for l2 in open('../../FunctionSearching/' + l1.strip() + '/eggnog_results.fa.emapper.annotations.tsv'):
			if(l2[:2] in recips and line[:4] not in exclude and line[:5] not in exclude):
				for term in l2.split('\t')[12].split(','):
					if term.strip() in weighted_counts_by_term:
						all_terms.append(term.strip())
						
	all_terms = list(dict.fromkeys(all_terms))

	slim_list = {'GO:0034605': ['GO:0006950', 'GO:0009628'], 'GO:0034356': ['GO:0009058', 'GO:0006139'], 'GO:0005307': ['GO:0005215'], 'GO:0001501': ['GO:0008150'], 'GO:0009165': ['GO:0006139', 'GO:0009058'], 'GO:0044281': ['GO:0008152'], 'GO:0044282': ['GO:0009056'], 'GO:0044283': ['GO:0009058'], 'GO:0098771': ['GO:0008150'], 'GO:0009698': ['GO:0019748'], 'GO:0010046': ['GO:0008150'], 'GO:0006307': ['GO:0006259'], 'GO:0051716': ['GO:0008150'], 'GO:0006304': ['GO:0006259'], 'GO:0000003': ['GO:0000003'], 'GO:0043207': ['GO:0009607', 'GO:0009605'], 'GO:0044550': ['GO:0009058', 'GO:0019748'], 'GO:0003091': ['GO:0008150'], 'GO:0000166': ['GO:0000166'], 'GO:0034698': ['GO:0009719'], 'GO:0098662': ['GO:0006811'], 'GO:0006281': ['GO:0006259', 'GO:0006950'], 'GO:0015849': ['GO:0006811'], 'GO:0050777': ['GO:0050789'], 'GO:0006833': ['GO:0006810'], 'GO:0050776': ['GO:0050789'], 'GO:0006836': ['GO:0006810'], 'GO:0071363': ['GO:0008150'], 'GO:0046483': ['GO:0008152'], 'GO:0010634': ['GO:0050789'], 'GO:0009607': ['GO:0009607'], 'GO:0006575': ['GO:0008152'], 'GO:0010632': ['GO:0050789'], 'GO:0019538': ['GO:0019538'], 'GO:0019539': ['GO:0009058', 'GO:0019748'], 'GO:0042698': ['GO:0008150'], 'GO:0045824': ['GO:0050789'], 'GO:0001505': ['GO:0008150'], 'GO:0019321': ['GO:0005975'], 'GO:0051252': ['GO:0050789'], 'GO:0006457': ['GO:0008150'], 'GO:0009893': ['GO:0050789'], 'GO:0009891': ['GO:0050789'], 'GO:0006950': ['GO:0006950'], 'GO:0017000': ['GO:0009058'], 'GO:0050778': ['GO:0050789'], 'GO:0031172': ['GO:0003824'], 'GO:1990591': ['GO:0006811'], 'GO:1905039': ['GO:0006811'], 'GO:0005488': ['GO:0005488'], 'GO:0072337': ['GO:0006811'], 'GO:0072330': ['GO:0009058'], 'GO:1901265': ['GO:0005488'], 'GO:0010646': ['GO:0050789'], 'GO:0008645': ['GO:0006811'], 'GO:0006886': ['GO:0015031'], 'GO:0009803': ['GO:0019748'], 'GO:0015552': ['GO:0005215'], 'GO:0008643': ['GO:0006811'], 'GO:0002684': ['GO:0050789'], 'GO:0002682': ['GO:0050789'], 'GO:0002683': ['GO:0050789'], 'GO:0043021': ['GO:0005488'], 'GO:0043022': ['GO:0005488'], 'GO:0043025': ['GO:0005575'], 'GO:0018130': ['GO:0009058'], 'GO:0048705': ['GO:0009653'], 'GO:0016787': ['GO:0016787'], 'GO:2000379': ['GO:0050789'], 'GO:0006629': ['GO:0006629'], 'GO:0032479': ['GO:0050789'], 'GO:0031253': ['GO:0005575'], 'GO:2000377': ['GO:0050789'], 'GO:0043412': ['GO:0008152'], 'GO:0032480': ['GO:0050789'], 'GO:0009267': ['GO:0006950', 'GO:0007154', 'GO:0009605'], 'GO:0009266': ['GO:0009628'], 'GO:0002520': ['GO:0008150'], 'GO:0009968': ['GO:0050789'], 'GO:0071345': ['GO:0008150'], 'GO:0071347': ['GO:0008150'], 'GO:0071346': ['GO:0008150'], 'GO:0015075': ['GO:0005215'], 'GO:0090482': ['GO:0005215'], 'GO:0010557': ['GO:0050789'], 'GO:0010556': ['GO:0050789'], 'GO:1902024': ['GO:0006811'], 'GO:0015179': ['GO:0005215'], 'GO:0070293': ['GO:0008150'], 'GO:0015174': ['GO:0005215'], 'GO:0006023': ['GO:0009058'], 'GO:0006020': ['GO:0005975'], 'GO:0006753': ['GO:0006139'], 'GO:0008194': ['GO:0016740'], 'GO:0015171': ['GO:0005215'], 'GO:0006024': ['GO:0009058'], 'GO:0008021': ['GO:0043226'], 'GO:0005342': ['GO:0005215'], 'GO:0005343': ['GO:0005215'], 'GO:0008028': ['GO:0005215'], 'GO:0034143': ['GO:0050789'], 'GO:0051128': ['GO:0050789'], 'GO:0120025': ['GO:0005575'], 'GO:1903825': ['GO:0006811'], 'GO:0034486': ['GO:0006810'], 'GO:0015809': ['GO:0006811'], 'GO:0014074': ['GO:0008150'], 'GO:0003097': ['GO:0006810'], 'GO:0031226': ['GO:0005575'], 'GO:0031224': ['GO:0005575'], 'GO:0010008': ['GO:0005575'], 'GO:0045177': ['GO:0005575'], 'GO:0051234': ['GO:0008150'], 'GO:1900026': ['GO:0050789'], 'GO:1900024': ['GO:0050789'], 'GO:0060284': ['GO:0050789'], 'GO:0005506': ['GO:0005488'], 'GO:0005507': ['GO:0005488'], 'GO:0110101': ['GO:0006811'], 'GO:0015672': ['GO:0006811'], 'GO:0050661': ['GO:0000166'], 'GO:0008284': ['GO:0050789'], 'GO:0070555': ['GO:0008150'], 'GO:0035239': ['GO:0009653'], 'GO:0050878': ['GO:0008150'], 'GO:0046379': ['GO:0005975'], 'GO:0006875': ['GO:0019725'], 'GO:0008324': ['GO:0005215'], 'GO:0006873': ['GO:0019725'], 'GO:0006974': ['GO:0006950'], 'GO:0034637': ['GO:0009058', 'GO:0005975'], 'GO:0001655': ['GO:0008150'], 'GO:0048519': ['GO:0050789'], 'GO:0044257': ['GO:0009056', 'GO:0019538'], 'GO:0044255': ['GO:0006629'], 'GO:0006979': ['GO:0006950'], 'GO:0016853': ['GO:0003824'], 'GO:0097237': ['GO:0008150'], 'GO:0016859': ['GO:0003824'], 'GO:0071944': ['GO:0005575'], 'GO:1904659': ['GO:0006811'], 'GO:1900563': ['GO:0019748', 'GO:0009058'], 'GO:0042127': ['GO:0050789'], 'GO:0015819': ['GO:0006811'], 'GO:0035510': ['GO:0006259'], 'GO:0015817': ['GO:0006811'], 'GO:0060349': ['GO:0009653'], 'GO:0060348': ['GO:0008150'], 'GO:0042592': ['GO:0008150'], 'GO:0022407': ['GO:0050789'], 'GO:0035690': ['GO:0008150'], 'GO:0042594': ['GO:0009605', 'GO:0006950'], 'GO:0043632': ['GO:0009056'], 'GO:0007275': ['GO:0007275'], 'GO:0022409': ['GO:0050789'], 'GO:0036146': ['GO:0008150'], 'GO:0033993': ['GO:0008150'], 'GO:2000112': ['GO:0050789'], 'GO:0019566': ['GO:0005975'], 'GO:0015355': ['GO:0005215'], 'GO:0006511': ['GO:0019538', 'GO:0009056'], 'GO:0043062': ['GO:0016043'], 'GO:0046683': ['GO:0008150'], 'GO:0045088': ['GO:0050789'], 'GO:0019219': ['GO:0050789'], 'GO:0045087': ['GO:0009605', 'GO:0009607', 'GO:0006950'], 'GO:0019748': ['GO:0019748'], 'GO:0000271': ['GO:0005975', 'GO:0009058'], 'GO:0006464': ['GO:0006464'], 'GO:0000272': ['GO:0005975', 'GO:0009056'], 'GO:0031326': ['GO:0050789'], 'GO:0030104': ['GO:0008150'], 'GO:0060485': ['GO:0008150'], 'GO:0044267': ['GO:0019538'], 'GO:0035461': ['GO:0006810'], 'GO:1901700': ['GO:0008150'], 'GO:1901701': ['GO:0008150'], 'GO:0040013': ['GO:0050789'], 'GO:0040012': ['GO:0050789'], 'GO:0008519': ['GO:0005215'], 'GO:0040017': ['GO:0050789'], 'GO:0008514': ['GO:0005215'], 'GO:0048856': ['GO:0008150'], 'GO:0072348': ['GO:0006810'], 'GO:0005737': ['GO:0005737'], 'GO:0006066': ['GO:0008152'], 'GO:0022857': ['GO:0005215'], 'GO:0009725': ['GO:0009719'], 'GO:0006790': ['GO:0008152'], 'GO:0006793': ['GO:0008152'], 'GO:0005768': ['GO:0005768'], 'GO:0048523': ['GO:0050789'], 'GO:0048522': ['GO:0050789'], 'GO:0004497': ['GO:0003824'], 'GO:0008104': ['GO:0008150'], 'GO:0042136': ['GO:0009058'], 'GO:0033494': ['GO:0008152'], 'GO:0009636': ['GO:0008150'], 'GO:0004499': ['GO:0003824'], 'GO:0015727': ['GO:0006811'], 'GO:0031348': ['GO:0050789'], 'GO:0003014': ['GO:0008150'], 'GO:0009966': ['GO:0050789'], 'GO:0015129': ['GO:0005215'], 'GO:0031347': ['GO:0050789'], 'GO:0071705': ['GO:0006810'], 'GO:0050728': ['GO:0050789'], 'GO:0045785': ['GO:0050789'], 'GO:0016021': ['GO:0005575'], 'GO:0016020': ['GO:0005575'], 'GO:0070848': ['GO:0008150'], 'GO:0016740': ['GO:0016740'], 'GO:0019184': ['GO:0009058'], 'GO:0044092': ['GO:0008150'], 'GO:0033036': ['GO:0008150'], 'GO:0032132': ['GO:0003677'], 'GO:0032131': ['GO:0003677'], 'GO:0051547': ['GO:0050789'], 'GO:0005319': ['GO:0005215'], 'GO:0030212': ['GO:0008152'], 'GO:0030213': ['GO:0009058'], 'GO:0099503': ['GO:0043226'], 'GO:0051119': ['GO:0005215'], 'GO:0098588': ['GO:0005575'], 'GO:0015696': ['GO:0006811'], 'GO:0044297': ['GO:0005575'], 'GO:0002507': ['GO:0008150'], 'GO:1902653': ['GO:0009058'], 'GO:1902652': ['GO:0008152'], 'GO:2001141': ['GO:0050789'], 'GO:0042995': ['GO:0005575'], 'GO:0051707': ['GO:0009607', 'GO:0009605'], 'GO:0010033': ['GO:0008150'], 'GO:0050501': ['GO:0016740'], 'GO:1901678': ['GO:0006811'], 'GO:0031668': ['GO:0007154', 'GO:0009605'], 'GO:0031669': ['GO:0009605', 'GO:0007154'], 'GO:0009605': ['GO:0009605'], 'GO:0003007': ['GO:0009653'], 'GO:0023057': ['GO:0050789'], 'GO:0005829': ['GO:0005829'], 'GO:0031667': ['GO:0009605'], 'GO:0031664': ['GO:0050789'], 'GO:0031665': ['GO:0050789'], 'GO:0010243': ['GO:0008150'], 'GO:0010648': ['GO:0050789'], 'GO:0015850': ['GO:0006811'], 'GO:0046713': ['GO:0006811'], 'GO:0002831': ['GO:0050789'], 'GO:0030335': ['GO:0050789'], 'GO:0002833': ['GO:0050789'], 'GO:0002832': ['GO:0050789'], 'GO:0006807': ['GO:0008152'], 'GO:0045324': ['GO:0006810'], 'GO:0046496': ['GO:0006139'], 'GO:0031310': ['GO:0005575'], 'GO:0002376': ['GO:0008150'], 'GO:0044264': ['GO:0005975'], 'GO:0045226': ['GO:0009058', 'GO:0005975'], 'GO:0046916': ['GO:0019725'], 'GO:0051180': ['GO:0006810'], 'GO:0044260': ['GO:0008152'], 'GO:0015318': ['GO:0005215'], 'GO:0097164': ['GO:0008152'], 'GO:0001568': ['GO:0008150'], 'GO:0023051': ['GO:0050789'], 'GO:1900619': ['GO:0008152'], 'GO:1902475': ['GO:0006811'], 'GO:0004141': ['GO:0003824'], 'GO:1903401': ['GO:0006811'], 'GO:1903400': ['GO:0006811'], 'GO:0009887': ['GO:0009653'], 'GO:0034613': ['GO:0008150'], 'GO:0016757': ['GO:0016740'], 'GO:0050793': ['GO:0050789'], 'GO:0009889': ['GO:0050789'], 'GO:0009888': ['GO:0008150'], 'GO:0050794': ['GO:0050789'], 'GO:0051239': ['GO:0050789'], 'GO:0031166': ['GO:0005575'], 'GO:0031169': ['GO:0019748', 'GO:0009058'], 'GO:0031168': ['GO:0019748'], 'GO:0015829': ['GO:0006811'], 'GO:0090407': ['GO:0009058'], 'GO:0036119': ['GO:0009719'], 'GO:0022890': ['GO:0005215'], 'GO:0097384': ['GO:0006629', 'GO:0009058'], 'GO:0034220': ['GO:0006811'], 'GO:0046394': ['GO:0009058'], 'GO:0046395': ['GO:0009056'], 'GO:0050896': ['GO:0008150'], 'GO:0050891': ['GO:0008150'], 'GO:0036117': ['GO:0005575'], 'GO:0032088': ['GO:0050789'], 'GO:0009059': ['GO:0009058'], 'GO:2000145': ['GO:0050789'], 'GO:0019631': ['GO:0009056'], 'GO:2000147': ['GO:0050789'], 'GO:2000146': ['GO:0050789'], 'GO:0009117': ['GO:0006139'], 'GO:0006518': ['GO:0008152'], 'GO:0006109': ['GO:0050789'], 'GO:1900104': ['GO:0050789'], 'GO:1900106': ['GO:0050789'], 'GO:0006631': ['GO:0006629'], 'GO:0016705': ['GO:0003824'], 'GO:0032102': ['GO:0050789'], 'GO:0032103': ['GO:0050789'], 'GO:0032101': ['GO:0050789'], 'GO:0001944': ['GO:0008150'], 'GO:0019679': ['GO:0006629'], 'GO:0051173': ['GO:0050789'], 'GO:0016798': ['GO:0016787'], 'GO:0042403': ['GO:0008152'], 'GO:0031301': ['GO:0005575'], 'GO:0031300': ['GO:0005575'], 'GO:0070887': ['GO:0008150'], 'GO:0005328': ['GO:0005326'], 'GO:0032885': ['GO:0050789'], 'GO:0032881': ['GO:0050789'], 'GO:0016491': ['GO:0003824'], 'GO:0071371': ['GO:0009719'], 'GO:0000413': ['GO:0006464'], 'GO:0031090': ['GO:0005575'], 'GO:0016709': ['GO:0003824'], 'GO:0016874': ['GO:0003824'], 'GO:0051240': ['GO:0050789'], 'GO:0051241': ['GO:0050789'], 'GO:0035873': ['GO:0006811'], 'GO:0009057': ['GO:0009056'], 'GO:0019674': ['GO:0008152'], 'GO:1903039': ['GO:0050789'], 'GO:0010769': ['GO:0050789'], 'GO:0015166': ['GO:0005215'], 'GO:0010762': ['GO:0050789'], 'GO:0051641': ['GO:0008150'], 'GO:0006590': ['GO:0008152'], 'GO:0010764': ['GO:0050789'], 'GO:1903037': ['GO:0050789'], 'GO:0005355': ['GO:0005215'], 'GO:0006694': ['GO:0009058', 'GO:0006629'], 'GO:0042044': ['GO:0006810'], 'GO:0048609': ['GO:0008150'], 'GO:0051272': ['GO:0050789'], 'GO:0005215': ['GO:0005215'], 'GO:0089709': ['GO:0006811'], 'GO:0071396': ['GO:0008150'], 'GO:0051271': ['GO:0050789'], 'GO:0016128': ['GO:0006629'], 'GO:0007565': ['GO:0008150'], 'GO:0034490': ['GO:0006811'], 'GO:0009403': ['GO:0019748', 'GO:0009058'], 'GO:0051270': ['GO:0050789'], 'GO:0009405': ['GO:0008150'], 'GO:0009404': ['GO:0019748'], 'GO:0009408': ['GO:0006950', 'GO:0009628'], 'GO:0043576': ['GO:0050789'], 'GO:0007034': ['GO:0006810'], 'GO:1901137': ['GO:0009058'], 'GO:1901135': ['GO:0008152'], 'GO:0042493': ['GO:0008150'], 'GO:0033692': ['GO:0005975', 'GO:0009058'], 'GO:1902680': ['GO:0050789'], 'GO:0035809': ['GO:0008150'], 'GO:0002237': ['GO:0009607', 'GO:0009605'], 'GO:0005515': ['GO:0005515'], 'GO:0034405': ['GO:0006950'], 'GO:0048731': ['GO:0008150'], 'GO:0015688': ['GO:0019725', 'GO:0006811'], 'GO:0097159': ['GO:0005488'], 'GO:0016126': ['GO:0006629', 'GO:0009058'], 'GO:0043386': ['GO:0009058', 'GO:0019748'], 'GO:0016125': ['GO:0006629'], 'GO:0045202': ['GO:0005575'], 'GO:0010106': ['GO:0006950', 'GO:0009605', 'GO:0007154'], 'GO:0036302': ['GO:0008150'], 'GO:0001837': ['GO:0030154'], 'GO:0072524': ['GO:0008152'], 'GO:0072525': ['GO:0009058'], 'GO:0009102': ['GO:0009058'], 'GO:0033214': ['GO:0006811', 'GO:0019725'], 'GO:0070405': ['GO:0005488'], 'GO:0006796': ['GO:0008152'], 'GO:0050789': ['GO:0050789'], 'GO:0015824': ['GO:0006811'], 'GO:0035725': ['GO:0006811'], 'GO:0071393': ['GO:0009719'], 'GO:0070401': ['GO:0000166'], 'GO:0016835': ['GO:0003824'], 'GO:0071627': ['GO:0005575'], 'GO:0045935': ['GO:0050789'], 'GO:0010810': ['GO:0050789'], 'GO:0010811': ['GO:0050789'], 'GO:0001570': ['GO:0030154'], 'GO:0010817': ['GO:0008150'], 'GO:0022414': ['GO:0008150'], 'GO:0042165': ['GO:0005488'], 'GO:0055065': ['GO:0008150'], 'GO:0047613': ['GO:0003824'], 'GO:0035295': ['GO:0008150'], 'GO:0034121': ['GO:0050789'], 'GO:1900620': ['GO:0009058'], 'GO:0008610': ['GO:0006629', 'GO:0009058'], 'GO:0015220': ['GO:0005215'], 'GO:0007507': ['GO:0008150'], 'GO:0032570': ['GO:0009719'], 'GO:0005975': ['GO:0005975'], 'GO:0005976': ['GO:0005975'], 'GO:0015343': ['GO:0005215'], 'GO:0044237': ['GO:0008152'], 'GO:0005365': ['GO:0005215'], 'GO:0019363': ['GO:0006139', 'GO:0009058'], 'GO:0006259': ['GO:0006259'], 'GO:0008292': ['GO:0009058'], 'GO:0008291': ['GO:0008152'], 'GO:0019362': ['GO:0006139'], 'GO:0016192': ['GO:0006810'], 'GO:0005783': ['GO:0005783'], 'GO:0019222': ['GO:0050789'], 'GO:0010393': ['GO:0005975'], 'GO:0048585': ['GO:0050789'], 'GO:0048584': ['GO:0050789'], 'GO:0048583': ['GO:0050789'], 'GO:0008204': ['GO:0006629'], 'GO:0072359': ['GO:0008150'], 'GO:0072358': ['GO:0008150'], 'GO:1990822': ['GO:0006811'], 'GO:1901362': ['GO:0009058'], 'GO:1901363': ['GO:0005488'], 'GO:1901360': ['GO:0008152'], 'GO:1901361': ['GO:0009056'], 'GO:0008507': ['GO:0005215'], 'GO:0015081': ['GO:0005215'], 'GO:0016999': ['GO:0008152'], 'GO:0005773': ['GO:0005773'], 'GO:0048869': ['GO:0008150'], 'GO:0008509': ['GO:0005215'], 'GO:0042537': ['GO:0008152'], 'GO:0005777': ['GO:0005777'], 'GO:0001822': ['GO:0008150'], 'GO:0005774': ['GO:0005575'], 'GO:0048511': ['GO:0008150'], 'GO:0060317': ['GO:0030154'], 'GO:0048513': ['GO:0008150'], 'GO:0048514': ['GO:0009653'], 'GO:0008202': ['GO:0006629'], 'GO:0010720': ['GO:0050789'], 'GO:0048518': ['GO:0050789'], 'GO:0019359': ['GO:0009058', 'GO:0006139'], 'GO:0046873': ['GO:0005215'], 'GO:0046872': ['GO:0005488'], 'GO:2001308': ['GO:0019748'], 'GO:0048762': ['GO:0030154'], 'GO:0015718': ['GO:0006811'], 'GO:1903785': ['GO:0006811'], 'GO:0015711': ['GO:0006811'], 'GO:0045184': ['GO:0008150'], 'GO:0045913': ['GO:0050789'], 'GO:0042221': ['GO:0008150'], 'GO:0007155': ['GO:0008150'], 'GO:0036477': ['GO:0005575'], 'GO:0043436': ['GO:0008152'], 'GO:1900561': ['GO:0019748'], 'GO:1900560': ['GO:0009058'], 'GO:0043433': ['GO:0050789'], 'GO:0003008': ['GO:0008150'], 'GO:0044703': ['GO:0008150'], 'GO:1901564': ['GO:0008152'], 'GO:1901565': ['GO:0009056'], 'GO:1901566': ['GO:0009058'], 'GO:0044706': ['GO:0008150'], 'GO:0016054': ['GO:0009056'], 'GO:0071320': ['GO:0009719'], 'GO:0016052': ['GO:0005975', 'GO:0009056'], 'GO:0016053': ['GO:0009058'], 'GO:0016051': ['GO:0009058', 'GO:0005975'], 'GO:0005416': ['GO:0005215'], 'GO:0007154': ['GO:0007154'], 'GO:1900625': ['GO:0050789'], 'GO:0033554': ['GO:0006950'], 'GO:0004553': ['GO:0016787'], 'GO:0019637': ['GO:0008152'], 'GO:0016758': ['GO:0016740'], 'GO:0045490': ['GO:0005975', 'GO:0009056'], 'GO:0098852': ['GO:0005575'], 'GO:0019630': ['GO:0008152'], 'GO:0022604': ['GO:0050789'], 'GO:0098590': ['GO:0005575'], 'GO:0022607': ['GO:0016043'], 'GO:0030203': ['GO:0008152'], 'GO:0022603': ['GO:0050789'], 'GO:0005326': ['GO:0005326'], 'GO:0043229': ['GO:0005622'], 'GO:0016882': ['GO:0003824'], 'GO:0003674': ['GO:0003674'], 'GO:0043385': ['GO:0019748'], 'GO:0003676': ['GO:0003676'], 'GO:0003677': ['GO:0003677'], 'GO:1903713': ['GO:0006811'], 'GO:0043170': ['GO:0008152'], 'GO:0043227': ['GO:0043226'], 'GO:0043226': ['GO:0043226'], 'GO:0034097': ['GO:0008150'], 'GO:0016129': ['GO:0006629', 'GO:0009058'], 'GO:0045117': ['GO:0006811'], 'GO:0071219': ['GO:0009607', 'GO:0009605'], 'GO:0071216': ['GO:0009607'], 'GO:0015908': ['GO:0006811'], 'GO:0042445': ['GO:0008152'], 'GO:0006812': ['GO:0006811'], 'GO:0006811': ['GO:0006811'], 'GO:0006810': ['GO:0006810'], 'GO:0042446': ['GO:0009058'], 'GO:0006814': ['GO:0006811'], 'GO:0006952': ['GO:0006950'], 'GO:0003824': ['GO:0003824'], 'GO:0043900': ['GO:0050789'], 'GO:0043901': ['GO:0050789'], 'GO:0012505': ['GO:0005575'], 'GO:0012506': ['GO:0005575'], 'GO:0006955': ['GO:0008150'], 'GO:0034654': ['GO:0009058', 'GO:0006139'], 'GO:0010604': ['GO:0050789'], 'GO:0072573': ['GO:0050789'], 'GO:0043902': ['GO:0050789'], 'GO:0044271': ['GO:0009058'], 'GO:0046907': ['GO:0006810'], 'GO:0007422': ['GO:0008150'], 'GO:0042930': ['GO:0006811'], 'GO:0042931': ['GO:0005215'], 'GO:0080134': ['GO:0050789'], 'GO:1900623': ['GO:0050789'], 'GO:0016830': ['GO:0003824'], 'GO:0002759': ['GO:0050789'], 'GO:0006355': ['GO:0050789'], 'GO:1901618': ['GO:0005215'], 'GO:0085029': ['GO:0016043'], 'GO:1901616': ['GO:0009056'], 'GO:1901617': ['GO:0009058'], 'GO:1901615': ['GO:0008152'], 'GO:0000324': ['GO:0005773'], 'GO:0000323': ['GO:0005773'], 'GO:0036452': ['GO:0005575'], 'GO:0030155': ['GO:0050789'], 'GO:0030154': ['GO:0030154'], 'GO:0000329': ['GO:0005575'], 'GO:0050727': ['GO:0050789'], 'GO:0042579': ['GO:0005622', 'GO:0043226'], 'GO:0015833': ['GO:0006811'], 'GO:1901201': ['GO:0050789'], 'GO:0009719': ['GO:0009719'], 'GO:0043169': ['GO:0005488'], 'GO:0043162': ['GO:0009056', 'GO:0019538'], 'GO:0036120': ['GO:0009719'], 'GO:0005739': ['GO:0005739'], 'GO:0043167': ['GO:0005488'], 'GO:0019541': ['GO:0006629'], 'GO:0015373': ['GO:0005215'], 'GO:0015370': ['GO:0005215'], 'GO:0043005': ['GO:0005575'], 'GO:0014910': ['GO:0050789'], 'GO:0006508': ['GO:0019538'], 'GO:0071495': ['GO:0009719'], 'GO:0032501': ['GO:0008150'], 'GO:0032504': ['GO:0000003'], 'GO:0051603': ['GO:0019538'], 'GO:1903053': ['GO:0050789'], 'GO:0009987': ['GO:0008150'], 'GO:0006725': ['GO:0008152'], 'GO:0071498': ['GO:0006950'], 'GO:1903506': ['GO:0050789'], 'GO:0032870': ['GO:0009719'], 'GO:0030003': ['GO:0019725'], 'GO:0043090': ['GO:0006811'], 'GO:0072001': ['GO:0008150'], 'GO:0032879': ['GO:0050789'], 'GO:0035445': ['GO:0006811'], 'GO:0090500': ['GO:0030154'], 'GO:0098862': ['GO:0005575'], 'GO:0050678': ['GO:0050789'], 'GO:0050679': ['GO:0050789'], 'GO:0000815': ['GO:0005575'], 'GO:0071407': ['GO:0008150'], 'GO:0015887': ['GO:0006811'], 'GO:0051254': ['GO:0050789'], 'GO:0044849': ['GO:0008150'], 'GO:0001817': ['GO:0050789'], 'GO:0015111': ['GO:0005215'], 'GO:0010770': ['GO:0050789'], 'GO:0016836': ['GO:0003824'], 'GO:0048545': ['GO:0009719'], 'GO:0080139': ['GO:0005215'], 'GO:0071222': ['GO:0009605', 'GO:0009607'], 'GO:0034135': ['GO:0050789'], 'GO:0071383': ['GO:0009719'], 'GO:0034136': ['GO:0050789'], 'GO:0006767': ['GO:0008152'], 'GO:0016831': ['GO:0003824'], 'GO:0009435': ['GO:0006139', 'GO:0009058'], 'GO:0071840': ['GO:0008150'], 'GO:0062013': ['GO:0050789'], 'GO:0062012': ['GO:0050789'], 'GO:0070295': ['GO:0006810'], 'GO:1900558': ['GO:0008152'], 'GO:0015077': ['GO:0005215'], 'GO:0070382': ['GO:0043226'], 'GO:0071704': ['GO:0008152'], 'GO:0071310': ['GO:0008150'], 'GO:1902023': ['GO:0006811'], 'GO:0015695': ['GO:0006811'], 'GO:0006082': ['GO:0008152'], 'GO:0071702': ['GO:0006811'], 'GO:0015698': ['GO:0006811'], 'GO:0005298': ['GO:0005215'], 'GO:1901293': ['GO:0006139', 'GO:0009058'], 'GO:0030336': ['GO:0050789'], 'GO:0006855': ['GO:0006810'], 'GO:0030334': ['GO:0050789'], 'GO:0034612': ['GO:0008150'], 'GO:0006696': ['GO:0009058', 'GO:0006629'], 'GO:0140096': ['GO:0003824'], 'GO:0015891': ['GO:0006811'], 'GO:0034341': ['GO:0008150'], 'GO:0036094': ['GO:0005488'], 'GO:0006022': ['GO:0008152'], 'GO:0009058': ['GO:0009058'], 'GO:0009110': ['GO:0009058'], 'GO:0042026': ['GO:0008150'], 'GO:0051171': ['GO:0050789'], 'GO:0051649': ['GO:0008150'], 'GO:0034599': ['GO:0006950'], 'GO:0009056': ['GO:0009056'], 'GO:0051179': ['GO:0008150'], 'GO:0046943': ['GO:0005215'], 'GO:0046942': ['GO:0006811'], 'GO:0042133': ['GO:0008152'], 'GO:0031526': ['GO:0005575'], 'GO:0015791': ['GO:0006811'], 'GO:1901654': ['GO:0008150'], 'GO:1901655': ['GO:0008150'], 'GO:0008523': ['GO:0005215'], 'GO:0046459': ['GO:0006629'], 'GO:0005367': ['GO:0005215'], 'GO:0009628': ['GO:0009628'], 'GO:0015878': ['GO:0006811'], 'GO:0018904': ['GO:0008152'], 'GO:0015871': ['GO:0006811'], 'GO:0030424': ['GO:0005575'], 'GO:0006820': ['GO:0006811'], 'GO:0055072': ['GO:0008150'], 'GO:0006826': ['GO:0006811'], 'GO:0055076': ['GO:0008150'], 'GO:0003855': ['GO:0003824'], 'GO:0000322': ['GO:0005773'], 'GO:0015804': ['GO:0006811'], 'GO:0046556': ['GO:0016787'], 'GO:0031982': ['GO:0043226'], 'GO:0070727': ['GO:0008150'], 'GO:0009617': ['GO:0009607', 'GO:0009605'], 'GO:0043043': ['GO:0009058'], 'GO:0071628': ['GO:0005575'], 'GO:0018193': ['GO:0006464'], 'GO:0015238': ['GO:0005215'], 'GO:0044419': ['GO:0008150'], 'GO:0051704': ['GO:0008150'], 'GO:2001310': ['GO:0019748', 'GO:0009058'], 'GO:0019725': ['GO:0019725'], 'GO:0044877': ['GO:0005488'], 'GO:0006766': ['GO:0008152'], 'GO:0060255': ['GO:0050789'], 'GO:0006768': ['GO:0008152'], 'GO:0032787': ['GO:0008152'], 'GO:0051591': ['GO:0008150'], 'GO:0030163': ['GO:0009056', 'GO:0019538'], 'GO:0072329': ['GO:0009056'], 'GO:0010876': ['GO:0008150'], 'GO:0043231': ['GO:0043226', 'GO:0005622'], 'GO:0048871': ['GO:0008150'], 'GO:1903826': ['GO:0006811'], 'GO:0048878': ['GO:0008150'], 'GO:0030198': ['GO:0016043'], 'GO:0015245': ['GO:0005215'], 'GO:0019439': ['GO:0009056'], 'GO:0019438': ['GO:0009058'], 'GO:0015705': ['GO:0006811'], 'GO:0072488': ['GO:0006811'], 'GO:0002922': ['GO:0050789'], 'GO:0002920': ['GO:0050789'], 'GO:0032496': ['GO:0009605', 'GO:0009607'], 'GO:1901576': ['GO:0009058'], 'GO:1901575': ['GO:0009056'], 'GO:0071356': ['GO:0008150'], 'GO:0016043': ['GO:0016043'], 'GO:0018208': ['GO:0006464'], 'GO:0015149': ['GO:0005215'], 'GO:0045488': ['GO:0005975'], 'GO:0065007': ['GO:0008150'], 'GO:0014070': ['GO:0008150'], 'GO:0098661': ['GO:0006811'], 'GO:0098660': ['GO:0006811'], 'GO:0022803': ['GO:0005215'], 'GO:0065009': ['GO:0008150'], 'GO:0065008': ['GO:0008150'], 'GO:0015145': ['GO:0005215'], 'GO:0015144': ['GO:0005215'], 'GO:0022804': ['GO:0005215'], 'GO:0051130': ['GO:0050789'], 'GO:0043168': ['GO:0005488'], 'GO:0015798': ['GO:0006811'], 'GO:0006139': ['GO:0006139'], 'GO:0047547': ['GO:0003824'], 'GO:0034144': ['GO:0050789'], 'GO:0036211': ['GO:0019538'], 'GO:0008150': ['GO:0008150'], 'GO:0097708': ['GO:0043226'], 'GO:0008152': ['GO:0008152'], 'GO:0034491': ['GO:0006811'], 'GO:0043255': ['GO:0050789'], 'GO:0035810': ['GO:0008150'], 'GO:0042737': ['GO:0009056'], 'GO:1902022': ['GO:0006811'], 'GO:1901698': ['GO:0008150'], 'GO:1901699': ['GO:0008150'], 'GO:0034219': ['GO:0006811'], 'GO:0071417': ['GO:0009719'], 'GO:0033265': ['GO:0005488'], 'GO:0005634': ['GO:0005634'], 'GO:0006869': ['GO:0006811'], 'GO:0006867': ['GO:0006811'], 'GO:0050801': ['GO:0008150'], 'GO:0006865': ['GO:0006811'], 'GO:0044248': ['GO:0009056'], 'GO:0044249': ['GO:0009058'], 'GO:0034641': ['GO:0008152'], 'GO:0005903': ['GO:0005575'], 'GO:0051082': ['GO:0005515'], 'GO:0034645': ['GO:0009058'], 'GO:0019290': ['GO:0019748', 'GO:0009058'], 'GO:0009653': ['GO:0009653'], 'GO:0042886': ['GO:0006810'], 'GO:0031410': ['GO:0043226'], 'GO:0016829': ['GO:0003824'], 'GO:0000041': ['GO:0006811'], 'GO:0044718': ['GO:0006811'], 'GO:0016879': ['GO:0003824'], 'GO:0022610': ['GO:0008150'], 'GO:0015294': ['GO:0005215'], 'GO:0015296': ['GO:0005215'], 'GO:0015291': ['GO:0005215'], 'GO:0003755': ['GO:0003824'], 'GO:0015293': ['GO:0005215'], 'GO:0044238': ['GO:0044238'], 'GO:0140161': ['GO:0005215'], 'GO:0015912': ['GO:0006811'], 'GO:0046165': ['GO:0009058'], 'GO:0015913': ['GO:0006811'], 'GO:0044107': ['GO:0008152'], 'GO:0010837': ['GO:0050789'], 'GO:0045595': ['GO:0050789'], 'GO:0015807': ['GO:0006811'], 'GO:0030001': ['GO:0006811'], 'GO:0045893': ['GO:0050789'], 'GO:0015802': ['GO:0006811'], 'GO:0015803': ['GO:0006811'], 'GO:0055080': ['GO:0008150'], 'GO:0018958': ['GO:0008152'], 'GO:0055082': ['GO:0019725'], 'GO:0034122': ['GO:0050789'], 'GO:0055085': ['GO:0006810'], 'GO:0055086': ['GO:0006139'], 'GO:0044108': ['GO:0009058'], 'GO:0043604': ['GO:0009058'], 'GO:0051090': ['GO:0050789'], 'GO:0015562': ['GO:0005215'], 'GO:0043603': ['GO:0008152'], 'GO:0051094': ['GO:0050789'], 'GO:0003333': ['GO:0006811'], 'GO:0005996': ['GO:0005975'], 'GO:0007566': ['GO:0008150'], 'GO:0045597': ['GO:0050789'], 'GO:0042364': ['GO:0009058'], 'GO:0005622': ['GO:0005622'], 'GO:0010628': ['GO:0050789'], 'GO:1900127': ['GO:0050789'], 'GO:0003723': ['GO:0003723'], 'GO:1900125': ['GO:0050789'], 'GO:0017144': ['GO:0008152'], 'GO:0003684': ['GO:0003677'], 'GO:0003729': ['GO:0003723'], 'GO:0032502': ['GO:0008150'], 'GO:0009991': ['GO:0009605'], 'GO:0031328': ['GO:0050789'], 'GO:0014911': ['GO:0050789'], 'GO:0009237': ['GO:0019748'], 'GO:0031325': ['GO:0050789'], 'GO:0031323': ['GO:0050789'], 'GO:0019751': ['GO:0008152'], 'GO:0019752': ['GO:0008152'], 'GO:1903510': ['GO:0008152'], 'GO:0090304': ['GO:0006139'], 'GO:0035458': ['GO:0008150'], 'GO:0071496': ['GO:0009605'], 'GO:0006879': ['GO:0019725'], 'GO:0030133': ['GO:0043226'], 'GO:0035456': ['GO:0008150'], 'GO:0015893': ['GO:0006810'], 'GO:0090513': ['GO:0006811'], 'GO:0050660': ['GO:0000166'], 'GO:0046271': ['GO:0019748', 'GO:0009056'], 'GO:0090517': ['GO:0006811'], 'GO:0044087': ['GO:0050789'], 'GO:0090518': ['GO:0006811'], 'GO:0098805': ['GO:0005575'], 'GO:0046281': ['GO:0009056', 'GO:0019748'], 'GO:0051549': ['GO:0050789'], 'GO:1903508': ['GO:0050789'], 'GO:0016324': ['GO:0005575'], 'GO:0005576': ['GO:0005576'], 'GO:0015101': ['GO:0005215'], 'GO:0001818': ['GO:0050789'], 'GO:0015103': ['GO:0005215'], 'GO:0033212': ['GO:0006811', 'GO:0019725'], 'GO:0010468': ['GO:0050789'], 'GO:0010838': ['GO:0050789'], 'GO:0015636': ['GO:0005215'], 'GO:0002760': ['GO:0050789'], 'GO:0019941': ['GO:0019538', 'GO:0009056'], 'GO:0015730': ['GO:0006811'], 'GO:0098656': ['GO:0006811'], 'GO:0044265': ['GO:0009056'], 'GO:0032975': ['GO:0006811'], 'GO:0005887': ['GO:0005575'], 'GO:0005886': ['GO:0005886'], 'GO:0044272': ['GO:0009058'], 'GO:0044262': ['GO:0005975'], 'GO:0080090': ['GO:0050789'], 'GO:0032991': ['GO:0005575'], 'GO:0046914': ['GO:0005488'], 'GO:0007399': ['GO:0008150'], 'GO:0005283': ['GO:0005215'], 'GO:0005575': ['GO:0005575'], 'GO:0098796': ['GO:0005575'], 'GO:0044085': ['GO:0008150'], 'GO:0098793': ['GO:0005575'], 'GO:0015749': ['GO:0006811'], 'GO:0015031': ['GO:0015031'], 'GO:0098655': ['GO:0006811'], 'GO:0044089': ['GO:0050789']}

# 	
	bad_terms = ['GO:0001302', 'GO:0005623', 'GO:0006732', 'GO:0006733', 'GO:0009108', 'GO:0044424', 'GO:0044464', 'GO:0051186', 'GO:0051188', 'GO:0048037', 'GO:0055114', 'GO:0044444', 'GO:0044422', 'GO:0044428', 'GO:0044446', 'GO:0044436', 'GO:0042891', 'GO:0042895', 'GO:0044425', 'GO:0044459', 'GO:0044463', 'GO:0051181', 'GO:0051182', 'GO:0120038', 'GO:0044434', 'GO:0044435', 'GO:0044429', 'GO:0044455', 'GO:0009109', 'GO:0051187', 'GO:0000988', 'GO:0000990', 'GO:0044433', 'GO:0044437', 'GO:0016681', 'GO:0044451', 'GO:0044445', 'GO:0001871', 'GO:0044432', 'GO:0008565', 'GO:0044110', 'GO:0044440', 'GO:0044430', 'GO:0070035', 'GO:0050662', 'GO:0044421', 'GO:0051184', 'GO:0044431', 'GO:0044456', 'GO:0097458', 'GO:0007016', 'GO:0044427', 'GO:0044449', 'GO:0044454', 'GO:1904499', 'GO:1904501', 'GO:0015307', 'GO:0051185', 'GO:0035392']
	
	for term in tqdm(all_terms):
		if(term not in bad_terms and term not in slim_list):
			slim_list.update({ term : [] })
			try:
				res = subprocess.check_output('map_to_slim.py --term=' + term.replace('"', '') + ' go-basic.obo goslim_generic.obo', shell = True)
				for line in res.split('\n'):
					if('GO:' in line):
						line = [t.strip() for t in line.split(';')]
						for t in line:
							if(t not in slim_list[term]):
								slim_list[term].append(t)
			except Exception as e:
				print('FAILED: ' + str(e) + ' ' + str(term))
				bad_terms.append(term)
	
	weighted_counts_by_term = { slim_list[t][0] : 0 for t in slim_list if t in weighted_counts_by_term }
	actual_counts_by_term = { slim_list[t][0] : 0 for t in slim_list if t in weighted_counts_by_term }
										
	for l1 in tqdm([l0 for l0 in open('ogs_to_use.txt')]):
		og = l1.strip()
	
		total_recips_in_tree = len([ln for ln in open('../../FunctionSearching/' + og + '/eggnog_results.fa.emapper.annotations.tsv') if ln[:2] in recips])
		
		taxa_by_term = { }
						
		for l2 in open('../../FunctionSearching/' + og + '/eggnog_results.fa.emapper.annotations.tsv'):
			if(l2[:2] in recips and line[:4] not in exclude and line[:5] not in exclude):
				for term in [term.strip() for term in l2.split('\t')[12].split(',') if term.strip() in weighted_counts_by_term and term not in bad_terms]:
					for slimmed in slim_list[term]:
						if(slimmed not in taxa_by_term):
							taxa_by_term.update({slimmed : [] })
						taxa_by_term[slimmed].append(l2[:10])
		try:
			for l3 in open('../../GoTermsFromPFams/' + og + '.tsv'):
				if(l3[:2] in recips and line[:4] not in exclude and line[:5] not in exclude):
					for term in [term.strip() for term in l3.split('\t')[1].split(',') if term.strip() in weighted_counts_by_term and term not in bad_terms]:	
						for slimmed in slim_list[term]:
							if(slimmed not in taxa_by_term):
								taxa_by_term.update({slimmed : [] })
							taxa_by_term[slimmed].append(l3[:10])
		except:
			pass
							
		for term in taxa_by_term:
			weighted_counts_by_term[term] += float(len(list(dict.fromkeys(taxa_by_term[term])))) / float(total_recips_in_tree)
			if(len(list(dict.fromkeys(taxa_by_term[term]))) >= 1):
				actual_counts_by_term[term] += 1
								
	desc_dict = { line.split(',')[0].strip() : line.split(',')[1].strip() for line in open('terms_and_descriptions.csv') }
	
	all_op_terms = ['GO:0000003', 'GO:0000166', 'GO:0003674', 'GO:0003676', 'GO:0003677', 'GO:0003723', 'GO:0003824', 'GO:0005215', 'GO:0005326', 'GO:0005488', 'GO:0005515', 'GO:0005575', 'GO:0005576', 'GO:0005622', 'GO:0005634', 'GO:0005737', 'GO:0005739', 'GO:0005768', 'GO:0005773', 'GO:0005777', 'GO:0005783', 'GO:0005829', 'GO:0005886', 'GO:0005975', 'GO:0006139', 'GO:0006259', 'GO:0006464', 'GO:0006629', 'GO:0006810', 'GO:0006811', 'GO:0006950', 'GO:0007154', 'GO:0007275', 'GO:0008150', 'GO:0008152', 'GO:0009056', 'GO:0009058', 'GO:0009605', 'GO:0009607', 'GO:0009628', 'GO:0009653', 'GO:0009719', 'GO:0015031', 'GO:0016043', 'GO:0016740', 'GO:0016787', 'GO:0019538', 'GO:0019725', 'GO:0019748', 'GO:0030154', 'GO:0043226', 'GO:0044238', 'GO:0050789']
			
	with open('slimmed_top_terms.csv', 'w') as o:
		o.write('Term,Description,Actual Count, Weighted Count\n')
		for term in all_op_terms:
			if(term in weighted_counts_by_term):
				o.write(term + ',' + desc_dict[term] + ',' + str(actual_counts_by_term[term]) + ',' + str(weighted_counts_by_term[term]) + '\n')
			else:
				o.write(term + ',' + desc_dict[term] + ',NA,NA\n')
						
				
def main():
		
	heat_maps()
	
	#top_terms_weighted_sums()
	

main()
				
